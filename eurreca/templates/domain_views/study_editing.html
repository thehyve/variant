{% extends "domain_views/study_specific.html" %}

{% block extraScripts %}
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
  <script type="text/javascript">
    genotypeCount = {% if genotypeCount %} {{ genotypeCount }} {% else %} 0 {% endif %}
    phenotypeCount = {% if phenotypeCount %} {{ phenotypeCount }} {% else %} 0 {% endif %}
    panelCount = {% if panelCount %} {{ panelCount }} {% else %} 0 {% endif %}
    interactionCount = {% if interactionCount %} {{ interactionCount }} {% else %} 0 {% endif %}
  </script>
  <script type="text/javascript" src="{{ STATIC_URL }}js/study_editing.js"></script>
  
  <link rel="stylesheet" type="text/css" 
                href="{{ STATIC_URL }}css/main.css" />
  
  <STYLE type="text/css">
    table #interactionTable {
      border: #006dba solid 1px;

    }
    caption #interactionTable {
      font-size: 16pt;
    }
    td #interactionTable {
      border-width: 1px;
      border-style: dotted;
      padding: 10px;
    }
    th #interactionTable {
      border-bottom: black dashed 1px;
      border-left: black dashed 1px;
      padding: 10px;
    }
    a #interactionTable {
      background-color: yellow;
      text-decoration: none;
    }
  </STYLE>
{% endblock %}

{% block studyBlock %}
  {% for form in formset %}
    {% if form.id.value == null or form.id.value == '' or form.id.value == None %}
      <form method="post" action="/studies/create/">
    {% else %}
      <form method="post" action="/studies/update/{{ form.id.value }}">
    {% endif %}
  
      {% csrf_token %}
      {{ formset.management_form }}
      {{ formsetGenotype.management_form }}
      
      {% for hid in form.hidden_fields %} {{hid}}{% endfor %}
      
      <p>Study</p>
      
      <table>
        {% for field in form %}
          {% if not field.name == 'id' %}
          
            {% if field.errors %}
              <tr class = "error {{ field.name }}">
              <td class= "error"></td>
            {% else %}
              <tr class = "formfield {{ field.name }}">
              <td class= "formspacer"></td>
            {% endif %}
            
            <td>{{ field.label_tag }}</td> 
            <td>{{ field }}</td>
            <td>
              {% if field.errors %}
                {% for error in field.errors %}
                  {{ error|escape }} 
                {% endfor %}
              {% endif %}
            </td>
            </tr>
          {% endif %}        
        {% endfor %}
      </table>
    
      <input type="submit" value="Submit"  />
      {% if form.id.value != None %}
          <span class="button">
            <a href="/studies/remove/{{ form.id.value }}">
              <img alt="Remove" src="{{ STATIC_URL }}images/icons/delete.png">
              Remove this study.
            </a>
          </span>
        {% endif %} 
        <p> {{ form.error_dict }} </p>
      {% endfor %}
  </form>
{% endblock studyBlock %} 